#!/bin/sh

cli=$HOME/.yawm/clients
ctl=$HOME/.yawm/.control

while read var val; do
	case "$var" in
	seq*) seq=$val;;
	esac
done < $cli

echo list-clients > $ctl

found=0
count=0
while :; do
	while read var val; do
		case "$var" in
		seq*)
			if [ "$seq" != "$val" ]; then
				found=1
				break
			fi
			;;
		esac
	done < $cli
	if [ $found -eq 1 -o $count -gt 5000 ]; then
		break
	fi
	count=$((count + 1))
done

menu -c 80 -r 24 -i -s 5 -f $HOME/.yawm/clients |
while read scr tag win info; do
	echo "focus-window $win" > $ctl
	exit 0
done
